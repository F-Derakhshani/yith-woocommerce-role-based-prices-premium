jQuery(document).ready(function(e){var r=e(".add_price_rule"),o=e(".product_price_list"),i=e(".type_price_rule_select"),a={message:null,overlayCSS:{background:"#fff",opacity:.6},ignoreIfBlocked:!0},c=e(".product_price_rule"),t=function(){o.sortable({items:"div.woocommerce_price_rule",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.8,revert:!0,axis:"y",handle:"h3",stop:function(e,r){}})};e(".woocommerce_price_rule.closed").each(function(r){e(this).find(".woocommerce_price_rule_data").hide()}),c.on("click",".toolbar .expand-close .expand_all_price_rule",function(r){var o=e(".woocommerce_price_rule.closed");o.each(function(r){e(this).toggleClass("closed").toggleClass("open"),e(this).find(".woocommerce_price_rule_data").show()})}),c.on("click",".toolbar .expand-close .close_all_price_rule",function(r){var o=e(".woocommerce_price_rule.open");o.each(function(r){e(this).toggleClass("closed").toggleClass("open"),e(this).find(".woocommerce_price_rule_data").hide()})}),c.on("click",".woocommerce_price_rule h3",function(r){e(r.target).filter(":input, option, .sort, .remove_row_price").length||(e(this).next(".woocommerce_price_rule_data").stop().slideToggle(),e(this).parent(".woocommerce_price_rule").toggleClass("closed").toggleClass("open"))}),r.on("click",function(r){r.preventDefault();var c=o.find(".woocommerce_price_rule").get(),t=c.length,n=i.val();if(""!=n){var l={ywcrbp_index:t,ywcrbp_type:n,action:ywcrbp_prd.actions.add_new_price_role,ywcrbp_plugin:ywcrbp_prd.plugin};o.parent().block(a),e.ajax({type:"POST",url:ywcrbp_prd.admin_url,data:l,dataType:"json",success:function(r){o.append(r.result),o.parent().unblock(),e("body").trigger("init_product_rule_price"),e("body").trigger("wc-enhanced-select-init")}})}}),o.on("blur change",".rule_name",function(r){var o=e(this).parents(".woocommerce_price_rule"),i=o.find("h3 > .price_rule_name"),a=e(this).val();i.html(a)}),o.on("click",".woocommerce_price_rule h3 .remove_row_price",function(r){r.preventDefault();var o=e(this).parent(),i=o.parent();setTimeout(function(){i.remove()},500)}),e(document).on("woocommerce_variations_loaded woocommerce_variations_added woocommerce_variations_saved",function(){var r=e(".add_variation_price_rule"),o=e(".product_variation_price_list"),i=function(){o.sortable({items:"div.woocommerce_variation_price_rule",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.8,revert:!0,axis:"y",handle:"span.header_variation_rule",stop:function(e,r){r.item.parent();r.item.closest(".woocommerce_variation").addClass("variation-needs-update"),c()}})},c=function(){e("button.cancel-variation-changes, button.save-variation-changes").removeAttr("disabled")};i(),r.on("click",function(r){r.preventDefault();var o=e(this).parents(".woocommerce_variation"),t=o.find(".product_variation_price_list"),n=t.find(".woocommerce_variation_price_rule").get().length,l=t.data("variation_loop"),_=o.find(".type_price_rule_select"),p=_.val();if(""!==p){var s={ywcrbp_index:n,ywcrbp_type:p,ywcrbp_loop:l,action:ywcrbp_prd.actions.add_new_variation_price_role,ywcrbp_plugin:ywcrbp_prd.plugin};o.block(a),e.ajax({type:"POST",url:ywcrbp_prd.admin_url,data:s,dataType:"json",success:function(r){t.append(r.result),o.unblock(),o.addClass("variation-needs-update"),e("body").trigger("wc-enhanced-select-init"),i(),c()}})}}),e(".woocommerce_variation_price_rule.closed").each(function(r){e(this).find(".woocommerce_variation_price_rule_data").hide()}),e(".variation_price_rule").on("click",".woocommerce_variation_price_rule span.header_variation_rule",function(r){e(r.target).filter(":input, option, .sort, .variation_remove_row_price").length||(e(this).parent().next(".woocommerce_variation_price_rule_data").stop().slideToggle(),e(this).parents(".woocommerce_variation_price_rule").toggleClass("closed").toggleClass("open"))}),e(".variation_price_rule").on("click",".close_all_variation_price_rule",function(r){r.preventDefault();var o=e(this).parents(".variation_price_rule"),i=o.find(".woocommerce_variation_price_rule.open");i.each(function(r){e(this).toggleClass("closed").toggleClass("open"),e(this).find(".woocommerce_variation_price_rule_data").hide()})}),e(".variation_price_rule").on("click",".expand_all_variation_price_rule",function(r){r.preventDefault();var o=e(this).parents(".variation_price_rule"),i=o.find(".woocommerce_variation_price_rule.closed");i.each(function(r){e(this).toggleClass("closed").toggleClass("open"),e(this).find(".woocommerce_variation_price_rule_data").show()})}),e(".variation_price_rule").on("change blur",".variation_val, .variation_role, .variation_rule_name",function(r){var o=e(this),i=o.parents(".woocommerce_variation");if(o.hasClass("variation_rule_name")){var a=o.val(),t=o.parents(".woocommerce_variation_price_rule"),n=t.find(".price_variation_rule_name");n.html(a)}i.addClass("variation-needs-update"),c()}),e(".variation_price_rule").on("click",".variation_remove_row_price",function(r){r.preventDefault();var o=e(this),i=o.closest(".woocommerce_variation_price_rule"),t=o.parents(".woocommerce_variation");t.block(a),setTimeout(function(){i.remove(),t.unblock(),t.addClass("variation-needs-update"),c()},500)})}),e(document).on("init_product_rule_price",function(){t()}).trigger("init_product_rule_price")});